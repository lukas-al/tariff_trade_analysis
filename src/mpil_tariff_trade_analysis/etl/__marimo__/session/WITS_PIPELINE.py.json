{
  "version": "1",
  "metadata": {
    "marimo_version": "0.13.8"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "bcb2641053d5f8dfb85d1f768a40d0be",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "beedd296758bd9fa69bdbc8964597aa3",
      "outputs": [],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "771bd681f82ccd1dec15c364f95b346d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Found 1918 subdirectories in data/raw/WITS_tariff/AVEMFN\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Found 1916 CSV files for AVEMFN\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Successfully scanned 1916 files, failed to scan 0 files\nCombining all scanned dfs\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Found 1521 subdirectories in data/raw/WITS_tariff/AVEPref\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Found 1520 CSV files for AVEPref\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Successfully scanned 1520 files, failed to scan 0 files\nCombining all scanned dfs\n"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "86d447fc1e74e66a5995b2913cc4b031",
      "outputs": [],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "6e70290e33b85fe8482a6b53baefa9ea",
      "outputs": [],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "4c8e2dd1dd9aa11a07d2b01ab878c1d6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "--- TRANSLATING AVEMFN ---\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of unique product codes before translation: 7823\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of H0 codes (not translated): 522299\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of HS codes successfully translated (renamed): 9505956\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of non-H0 HS codes left alone (no translation found): 2401\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of unique product codes after translation: 6348\n--- TRANSLATING AVEPref ---\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of unique product codes before translation: 6986\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of H0 codes (not translated): 374194\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of HS codes successfully translated (renamed): 35654624\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of non-H0 HS codes left alone (no translation found): 1525\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "Number of unique product codes after translation: 5468\n"
        }
      ]
    },
    {
      "id": "Xref",
      "code_hash": "6e9c94b85573469a6f76ea93c35bde9d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>Schema({'year': String, 'reporter_country': String, 'product_code': String, 'hs_revision': String, 'tariff_rate': String, 'min_rate': String, 'max_rate': String, 'tariff_type': String})</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "365c9f0d184256c0fc447b84275444af",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Translated and regaggregated lf AVEMFN head:\nshape: (5, 7)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 reporter_country \u2506 year \u2506 product_code \u2506 tariff_type \u2506 tariff_rate \u2506 min_rate \u2506 max_rate \u2502\n\u2502 ---              \u2506 ---  \u2506 ---          \u2506 ---         \u2506 ---         \u2506 ---      \u2506 ---      \u2502\n\u2502 str              \u2506 str  \u2506 str          \u2506 str         \u2506 f32         \u2506 f32      \u2506 f32      \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502 512              \u2506 2005 \u2506 190410       \u2506 AVEMFN      \u2506 5.0         \u2506 5.0      \u2506 5.0      \u2502\n\u2502 136              \u2506 2020 \u2506 252510       \u2506 AVEMFN      \u2506 22.0        \u2506 22.0     \u2506 22.0     \u2502\n\u2502 918              \u2506 2001 \u2506 290517       \u2506 AVEMFN      \u2506 5.5         \u2506 5.5      \u2506 5.5      \u2502\n\u2502 156              \u2506 2021 \u2506 900791       \u2506 AVEMFN      \u2506 8.0         \u2506 8.0      \u2506 8.0      \u2502\n\u2502 356              \u2506 2011 \u2506 551513       \u2506 AVEMFN      \u2506 null        \u2506 null     \u2506 null     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"
        }
      ]
    },
    {
      "id": "BYtC",
      "code_hash": "2c09f604c346e4a05b4a64a3945fa236",
      "outputs": [],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "ffbf8ecb49b2e318400afcecddfe2d60",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"remap-partner-codes-for-avepref\">Remap partner codes for AVEPref</h1></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "47fdc1b7fc45ad49e06db8111cca1c32",
      "outputs": [],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "ac7d614aa0b3aa787c583062614c9494",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"translate-country-codes\">Translate country codes</h1>\n<span class=\"paragraph\">Now we have everything in ISO Numeric 3 digit space, we need to remap the WITS codes to our ISO ones.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "a04d9df8452ae919740922ce22650a0c",
      "outputs": [],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "8e5b7871d0df07be43921e81a0b30901",
      "outputs": [],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "94226a386fe99b9e2a985c1a8a0c6d13",
      "outputs": [],
      "console": []
    },
    {
      "id": "ZHCJ",
      "code_hash": "0c004711aaf863404339f820a8a44fb5",
      "outputs": [],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "e618a096647974e510c2051f4f225858",
      "outputs": [],
      "console": []
    },
    {
      "id": "qnkX",
      "code_hash": "89207e7e83c64f69805fac4f5069f9c4",
      "outputs": [],
      "console": []
    },
    {
      "id": "TqIu",
      "code_hash": "90b4276537e1a69519354ed86a679b65",
      "outputs": [],
      "console": []
    },
    {
      "id": "Vxnm",
      "code_hash": "b89e8f426d2773282efc8cb97ad2cb1d",
      "outputs": [],
      "console": []
    },
    {
      "id": "DnEU",
      "code_hash": "5e983de06cbb1755ab14df282585e8ee",
      "outputs": [],
      "console": []
    },
    {
      "id": "FVkM",
      "code_hash": "07bc0a9a11d5904760d5a7ce79a7596d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='FVkM-0' random-id='2e45496b-4227-0bf9-5791-b9d80b3d7105'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;year&#92;&quot;:&#92;&quot;1995&#92;&quot;,&#92;&quot;reporter_country&#92;&quot;:&#92;&quot;756&#92;&quot;,&#92;&quot;product_code&#92;&quot;:&#92;&quot;010111&#92;&quot;,&#92;&quot;tariff_rate&#92;&quot;:3.75,&#92;&quot;min_rate&#92;&quot;:0.2,&#92;&quot;max_rate&#92;&quot;:7.3,&#92;&quot;tariff_type&#92;&quot;:&#92;&quot;AVEMFN&#92;&quot;},{&#92;&quot;year&#92;&quot;:&#92;&quot;1995&#92;&quot;,&#92;&quot;reporter_country&#92;&quot;:&#92;&quot;756&#92;&quot;,&#92;&quot;product_code&#92;&quot;:&#92;&quot;010119&#92;&quot;,&#92;&quot;tariff_rate&#92;&quot;:35.67,&#92;&quot;min_rate&#92;&quot;:0.24,&#92;&quot;max_rate&#92;&quot;:103.42,&#92;&quot;tariff_type&#92;&quot;:&#92;&quot;AVEMFN&#92;&quot;},{&#92;&quot;year&#92;&quot;:&#92;&quot;1995&#92;&quot;,&#92;&quot;reporter_country&#92;&quot;:&#92;&quot;756&#92;&quot;,&#92;&quot;product_code&#92;&quot;:&#92;&quot;010120&#92;&quot;,&#92;&quot;tariff_rate&#92;&quot;:114.02,&#92;&quot;min_rate&#92;&quot;:2.41,&#92;&quot;max_rate&#92;&quot;:336.9,&#92;&quot;tariff_type&#92;&quot;:&#92;&quot;AVEMFN&#92;&quot;},{&#92;&quot;year&#92;&quot;:&#92;&quot;1995&#92;&quot;,&#92;&quot;reporter_country&#92;&quot;:&#92;&quot;756&#92;&quot;,&#92;&quot;product_code&#92;&quot;:&#92;&quot;010210&#92;&quot;,&#92;&quot;tariff_rate&#92;&quot;:36.51,&#92;&quot;min_rate&#92;&quot;:1.62,&#92;&quot;max_rate&#92;&quot;:67.44,&#92;&quot;tariff_type&#92;&quot;:&#92;&quot;AVEMFN&#92;&quot;},{&#92;&quot;year&#92;&quot;:&#92;&quot;1995&#92;&quot;,&#92;&quot;reporter_country&#92;&quot;:&#92;&quot;756&#92;&quot;,&#92;&quot;product_code&#92;&quot;:&#92;&quot;010290&#92;&quot;,&#92;&quot;tariff_rate&#92;&quot;:157.98,&#92;&quot;min_rate&#92;&quot;:2.17,&#92;&quot;max_rate&#92;&quot;:317.47,&#92;&quot;tariff_type&#92;&quot;:&#92;&quot;AVEMFN&#92;&quot;}]&quot;' data-total-rows='5' data-total-columns='7' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;year&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;reporter_country&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;product_code&quot;, [&quot;string&quot;, &quot;str&quot;]], [&quot;tariff_rate&quot;, [&quot;number&quot;, &quot;f32&quot;]], [&quot;min_rate&quot;, [&quot;number&quot;, &quot;f32&quot;]], [&quot;max_rate&quot;, [&quot;number&quot;, &quot;f32&quot;]], [&quot;tariff_type&quot;, [&quot;string&quot;, &quot;str&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "umth",
      "code_hash": "40550dc4ae51eb3c1fbd190b0974e9e9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Translated and regaggregated lf AVEPref head:\nshape: (5, 8)\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 reporter_co \u2506 partner_cou \u2506 year \u2506 product_cod \u2506 tariff_type \u2506 tariff_rate \u2506 min_rate \u2506 max_rate \u2502\n\u2502 untry       \u2506 ntry        \u2506 ---  \u2506 e           \u2506 ---         \u2506 ---         \u2506 ---      \u2506 ---      \u2502\n\u2502 ---         \u2506 ---         \u2506 str  \u2506 ---         \u2506 str         \u2506 f32         \u2506 f32      \u2506 f32      \u2502\n\u2502 str         \u2506 str         \u2506      \u2506 str         \u2506             \u2506             \u2506          \u2506          \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502 048         \u2506 N61         \u2506 2014 \u2506 760310      \u2506 AVEPref     \u2506 0.0         \u2506 0.0      \u2506 0.0      \u2502\n\u2502 710         \u2506 01J         \u2506 2023 \u2506 610520      \u2506 AVEPref     \u2506 0.0         \u2506 0.0      \u2506 0.0      \u2502\n\u2502 524         \u2506 N47         \u2506 2016 \u2506 732429      \u2506 AVEPref     \u2506 7.25        \u2506 7.25     \u2506 7.25     \u2502\n\u2502 634         \u2506 N62         \u2506 2013 \u2506 440391      \u2506 AVEPref     \u2506 0.0         \u2506 0.0      \u2506 0.0      \u2502\n\u2502 807         \u2506 B30         \u2506 2018 \u2506 710122      \u2506 AVEPref     \u2506 0.0         \u2506 0.0      \u2506 0.0      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"
        }
      ]
    }
  ]
}